<!DOCTYPE html>
<html>
<head>
    <title>Quiz App</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="{{ url_for('static', filename='script.js') }}"></script>
</head>
<body>

{% if finished %}
    <!-- Quiz Finished -->
    <h1>Quiz Finished!</h1>
    <p class="score">Your score: {{ score }} / {{ total }}</p>
    <div style="text-align:center; margin-top: 30px;">
        <a href="{{ url_for('home') }}"><button>Back to Home</button></a>
    </div>

{% else %}
    <h1>Quiz: {{ language|capitalize if language else '' }}</h1>

    <!-- Progress Bar -->
    <div class="progress-container">
        <div class="progress-bar" style="width: {{ (question_number / total_questions) * 100 }}%;"></div>
    </div>
    <p>Progress: {{ question_number }}/{{ total_questions }}</p>

    {% if show_feedback %}
        <!-- Feedback Section -->
        <p><strong>{{ feedback_msg }}</strong></p>
        {% if question.explanation %}
            <p><em>Explanation: {{ question.explanation }}</em></p>
        {% endif %}

        <!-- Next Question Button -->
        <form method="POST">
            <button type="submit" name="next_question">Next Question</button>
        </form>

        <!-- Options Highlighted -->
        <ul>
            {% for opt in options %}
                {% if opt == correct %}
                    <li class="option correct">{{ opt }} {% if selected == opt %}(Your choice){% endif %}</li>
                {% elif opt == selected %}
                    <li class="option incorrect">{{ opt }} (Your choice)</li>
                {% else %}
                    <li class="option">{{ opt }}</li>
                {% endif %}
            {% endfor %}
        </ul>

    {% else %}
        <!-- Question Form -->
        <form method="POST">
            <p><strong>{{ question.question }}</strong></p>
            {% for opt in options %}
                <div class="option">
                    <input type="radio" name="option" value="{{ opt }}" required> {{ opt }}
                </div>
            {% endfor %}
            <button type="submit">Submit Answer</button>
        </form>
    {% endif %}

    <!-- Back to Home Button fixed at bottom -->
    <div style="position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); z-index: 1000;">
        <a href="{{ url_for('home') }}">
            <button type="button">Back to Home</button>
        </a>
    </div>
{% endif %}

<script>
    // Highlight correct/incorrect after feedback
    {% if show_feedback %}
        highlightAnswer("{{ selected }}", "{{ correct }}");
    {% endif %}
</script>

</body>
</html>